{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productos | VGLuxeBeauty</title>
    <link rel="stylesheet" href="{% static 'css/productos.css' %}">
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400..700&display=swap"  rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>
<body>
    {% include 'partials/header.html' %}
    <main class="productos-page">
        <!-- Header -->
         <div class="productos-header">
            <h1>Productos</h1>
            <p>Descubre nuestra exclusiva selección de productos de belleza</p>
        </div>

        <!-- Filtros y Ordenamiento-->
         <div class="filtros-container">
            <div class="filtros-categorias">
                <a href="{% url 'productos' %}" class="filtro-btn {% if not categoria_actual %}activo{% endif %}">
                Todos
            </a>
            {% for cat in categorias %}
            <a href="?categoria={{ cat }}" class="filtro-btn {% if categoria_actual == cat %}activo{% endif %}">
                {{ cat }}
            </a>
            {% endfor %}
            </div>

            <div class="ordenar-container">
                <label for="ordenar">Ordenar por:</label>
                <select id="ordenar" class="ordenar-select" onchange="ordenarProductos(this.value)">
                    <option value="reciente" {% if orden_actual == 'reciente' %}selected{% endif %}>Más reciente</option>
                    <option value="precio_menor" {% if orden_actual == 'precio_menor' %}selected{% endif %}>Precio: menor a mayor</option>
                    <option value="precio_mayor" {% if orden_actual == 'precio_mayor' %}selected{% endif %}>Precio: mayor a menor</option>
                    <option value="nombre" {% if orden_actual == 'nombre' %}selected{% endif %}>Nombre: A-Z</option>
                </select>
            </div>
        </div>
        <!-- Grid de Productos -->
         {% if productos %}
         <div class="productos-grid">
            {% for producto in productos %}
            <div class="producto-card">
                <div class="producto-imagen">
                 <img src="{{ producto.imagen.url }}" alt="{{ producto.nombre }}">
                 {% if producto.stock <= 5 and producto.stock > 0 %}
                    <span class="stock-badge stock-bajo">Ultimas unidades</span>
                 {% elif producto.stock == 0 %}
                    <span class="stock-badge sin-stock">Agotado</span>
                 {% endif %}   
                </div>
                <div class="producto-info">
                    <div class="producto-categoria">
                        {{ producto.categoria }}
                    </div>
                    <h3 class="producto-nombre">{{ producto.nombre }}</h3>
                    <p class="producto-descripcion">{{ producto.descripcion }}</p>
                    <div class="producto-footer">
                        <span class="producto-precio">${{ producto.precio }}</span>
                        <a href="{% url 'producto_detalle' producto.id %}" class="btn-ver-detalle">Ver Detalle</a>
                    </div>
                </div> 
            </div>
            {% endfor %}
        </div>
        <!-- Paginacion -->
         {% if productos.has_other_pages %}
         <div class="paginacion">
            {% if productos.has_previous %}
                <a href="?page=1{% if categoria_actual %}&categoria={{ categoria_actual }}{% endif %}{% if orden %}&orden={{ orden }}{% endif %}">
                    <i class="bi bi-chevron-double-left"></i>
                </a>
                <a href="?page={{ productos.paginator.num_pages }}{% if categoria_actual %}&categoria={{ categoria_actual }}{% endif %}{% if orden %}&orden={{ orden }}{% endif %}">
                    <i class="bi bi-chevron-double-right"></i>
                </a>
            {% else %}
                <span class="disabled"><i class="bi bi-chevron-right"></i></span>
                <span class="disabled"><i class="bi bi-chevron-double-right"></i></span>
            {% endif %}
        </div>
        {% endif %}

        {% else %}
        <!--- Sin resultados -->
        <div class="sin-resultados">
            <i class="bi bi-search"></i>
            <h3>No se encontraron productos</h3>
            <p>Intenta con otra búsqueda o categoría.</p>
        </div>
        {% endif %}
    </main>
    {% include 'partials/footer.html' %}
    
    <script>
        function ordenarProductos(orden) {
            const url = new URL(window.location);
            url.searchParams.set('orden', orden);
            window.location = url;
        }
    </script>
</body>
</html>






            